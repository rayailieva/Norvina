<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <th:block th:include="~{fragments/head}"></th:block>
</head>
<body class="bg-body justify-content-center">
<header>
    <th:block th:include="~{fragments/navbar}"></th:block>
</header>
<body onload="loadSidebar()">
<div class="d-flex" id="wrapper">

    <!-- Sidebar -->
    <div class="bg-light border-right" id="sidebar-wrapper">
        <div class="sidebar-heading">Our Brands</div>
        <div class="list-group list-group-flush">
            <th:block th:each="brand : ${brands}" th:object="${brand}">
                <a class="list-group-item list-group-item-action bg-light"
                   th:href="@{/brands/products/{id}(id=${brand.id})}" th:text="${brand.name}"
                   th:value="*{name}"></a>
            </th:block>
            <button id="menu-toggle" class="list-group-item list-group-item-action bg-light">Close</button>
        </div>
    </div>

    <main class="mt-3 container">
        <div class="jumbotron mt-3 bg-notino">
            <h1 class="text-white text-center">NORVINA</h1>
            <h1 class="text-white text-center">World's best cosmetics online retailer.</h1>
            <hr class="bg-white hr-2"/>
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="https://i.notino.com/images/gallery/ba/17/vb_WEB_loreal_14_po_19.jpg"
                             class="d-block w-100" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="https://i.notino.com/images/gallery/ba/17/vb_dk_se_fi_WEB_koktejl_14_po_19.jpg"
                             class="d-block w-100" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="https://i.notino.com/images/gallery/ba/17/N_Mineral89_1035x340_UK.jpg"
                             class="d-block w-100" alt="...">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <div class="row text-center mt-3">
                <div class="mx-auto">
                    <p><a th:href="@{/category/fragrances}" th:text="FRAGRANCES" class="bg-notino-pink"></a></p>
                    <img src="https://i.notino.com/images/gallery/hp-category/hp-niche_2k.jpg" class="float-left"
                         width="300px" alt="Image">
                </div>
                <div class="mx-auto">
                    <p><a th:href="@{/category/hair}" th:text="HAIR" class="bg-notino-pink"></a></p>
                    <img src="https://i.notino.com/images/gallery/hp-category/hp-hair_2k.jpg" class="float-right"
                         width="300px" alt="Image">
                </div>
                <div class="mx-auto">
                    <p><a th:href="@{/category/skin}" th:text="SKIN" class="bg-notino-pink"></a></p>
                    <img src="https://i.notino.com/images/gallery/hp-category/hp-skin_2k.jpg" class="float-left"
                         width="300px" alt="Image">
                </div>
            </div>
            <div class="container-fluid bg-3 text-center align-content-center">
                <div class="row align-content-md-center">
                    <div class="mx-auto">
                        <p><a th:href="@{/category/body}" th:text="BODY" class="bg-notino-pink"></a></p>
                        <img src="https://i.notino.com/images/gallery/hp-category/hp-body_2k.jpg" class="float-right"
                             width="300px" alt="Image">
                    </div>
                    <div class="mx-auto">
                        <p><a th:href="@{/category/makeup}" th:text="MAKEUP" class="bg-notino-pink"></a></p>
                        <img src="https://i.notino.com/images/gallery/hp-category/make-up_2k.jpg" class="float-left"
                             width="300px" alt="Image">
                    </div>
                    <div class="mx-auto">
                        <p><a th:href="@{/category/sun}" th:text="SUN" class="bg-notino-pink"></a></p>
                        <img src="https://i.notino.com/images/gallery/hp-category/hp-sun_2k.jpg" class="float-right"
                             width="300px" alt="Image">
                    </div>
                </div>
            </div>
            <br/>


            <div th:id="content-container" class="d-flex justify-content-center bg-notino-pink mb-3">
                <form>
                    <input class="form-check-input" type="checkbox" onclick="showProducts()" id="productsOption">
                    <h2><label class="form-check-label" for="productsOption">View All Of Our Products Now!</label>
                    </h2>
                </form>
            </div>
        </div>

        <hr/>

</main>

</div>
</body>

<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });

    function openSidebar() {
        document.getElementById("sidebar-wrapper").style.display = "block";
    }

    // async function loadSidebar() {
    //     return new Promise(resolve => {
    //         setTimeout(() => {
    //             openSidebar();
    //         }, 3000);
    //     });
    // }

    function showProducts() {

        fetch('/fetch/products')
            .then((response) => response.json())
            .then((json) => {
                $('#customText').text('All Products');
                $('.container #content-container').remove();
                $('.container').append('<div id="content-container" class="mt-4 bg-notino-pink"></div>');

                let table =
                    ` <table class="table table-hover w-75 mx-auto bg-white" >
        <thead>
        <tr class="row mx-auto">
                <th class="col-md-1 text-center">#</th>
                <th class="col-md-3 text-center">Image</th>
                <th class="col-md-2 text-center">Name</th>
                <th class="col-md-2 text-center">Price</th>
                <th class="col-md-3 text-center">Actions</th>
            </tr>
        </thead>
        <tbody>`;

                json.forEach((product, index) => {
                    table +=
                        `<tr class="row mx-auto">
                     <th class="col-md-1 text-center">${index + 1}</th>
                     <td class="col-md-3 text-center">
                       <img src="${product.imageUrl}" class="product-image-home img-thumbnail" width="40" height="40"/></a>
                      </td>
                     <td class="col-md-2 text-center">${product.name}</td>
                     <td class="col-md-2 text-center">${product.price}</td>
                     <td class="col-md-3 text-center">
                    <a href="/products/details/${product.id}" class="btn btn-outline-dark text-info">Details</a>
                </td>
                   </tr>`;
                });
                table +=
                    '<tbody>' +
                    '</table>';

                $('#content-container').append(table);
            });
    }


</script>

<footer>
    <th:block th:include="~{fragments/footer}"></th:block>
</footer>
</body>
</html>